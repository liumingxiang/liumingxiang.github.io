<!DOCTYPE html><html><head><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><title> angular directive · 刘小窝</title><meta name="description" content="angular directive - John Doe"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="icon" href="/favicon.png"><link rel="stylesheet" href="/css/apollo.css"><link rel="search" type="application/opensearchdescription+xml" href="http://yoursite.com/atom.xml" title="刘小窝"></head><body><div class="wrap"><header><a href="/" class="logo-link"><img src="/favicon.png" alt="logo"></a><ul class="nav nav-list"><li class="nav-list-item"><a href="/" target="_self" class="nav-list-link">博客</a></li><li class="nav-list-item"><a href="/archives/" target="_self" class="nav-list-link">文章列表</a></li></ul></header><main class="container"><div class="post"><article class="post-block"><h1 class="post-title">angular directive</h1><div class="post-info">Feb 18, 2017</div><div class="post-content"><p>突然间之前一个同事问我angular自定义指令是什么鬼，我也突然间蒙了，但是我也知道怎么用，就是表述不清楚了，所以这两天查了查google angular的API，本着不误人子弟的原则，我写下了这篇文章，希望也能帮到你</p>
<p>什么是指令呢？我们先看官方的说法</p>
<h5 id="What-are-Directives"><a href="#What-are-Directives" class="headerlink" title="What are Directives?"></a>What are Directives?</h5><p>At a high level, directives are markers on a DOM element (such as an attribute, element name, comment or CSS class) that tell AngularJS’s <strong>HTML compiler</strong> (<a href="https://docs.angularjs.org/api/ng/service/$compile" target="_blank" rel="external"><code>$compile</code></a>) to attach a specified behavior to that DOM element (e.g. via event listeners), or even to transform the DOM element and its children.</p>
<p>AngularJS comes with a set of these directives built-in, like <code>ngBind</code>, <code>ngModel</code>, and <code>ngClass</code>. Much like you create controllers and services, you can create your own directives for AngularJS to use. When AngularJS <a href="https://docs.angularjs.org/guide/bootstrap" target="_blank" rel="external">bootstraps</a> your application, the <a href="https://docs.angularjs.org/guide/compiler" target="_blank" rel="external">HTML compiler</a> traverses the DOM matching directives against the DOM elements.</p>
<p>在高的层面上讲，指令是DOM元素中的标记(例如一个属性，一个节点名，注释或者CSS类)，它告诉angularjs编译器去给这个元素附加一个指令的行为或者转换DOM元素和它的子元素。</p>
<p>Angularjs拥有一些内建的指令，像ngBind、ngModel和ngClass。非常类似于你创建自己的controller和service，你可以创建你自己的指令个angularjs使用，当angular初始化启动你的应用程序，html编译器将遍历你的DOM元素并且去匹配指令。</p>
<a id="more"></a>
<p>实例解析expander</p>
<p>实例解析accordion</p>
<p>指令的运行原理 compile和link</p>
<p><img src="/images/ng-link.png" alt="img"></p>
<h3 id="指令定义的基础"><a href="#指令定义的基础" class="headerlink" title="指令定义的基础"></a>指令定义的基础</h3><p>在Angular中，定义指令需要调用<code>directive</code>方法，该方法接收两个参数：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> app = angular.module(<span class="string">'myapp'</span>, []);</div><div class="line">app.directive(name, fn);</div></pre></td></tr></table></figure>
<p>在定义的模块上使用<code>directive</code>方法创建一个指令，name为指令的名称，fn是一个函数，它将返回一个对象，在这个对象中，定义了这个指令的全部行为</p>
<h4 id="restrict匹配模式"><a href="#restrict匹配模式" class="headerlink" title="restrict匹配模式"></a>restrict匹配模式</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line">&lt;div&gt;</div><div class="line">  &lt;ts-hello&gt;&lt;/ts-hello&gt;</div><div class="line">  &lt;div ts-hello&gt;&lt;/div&gt;</div><div class="line">  &lt;div class="ts-hello"&gt;&lt;/div&gt;</div><div class="line">  &lt;div data-ts-hello&gt;&lt;/div&gt;</div><div class="line">&lt;/div&gt;</div><div class="line">&lt;script&gt;</div><div class="line">  <span class="keyword">var</span> app = angular.module(<span class="string">'myapp'</span>, []);</div><div class="line">  app.directive(<span class="string">'tsHello'</span>, <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">    <span class="keyword">return</span> &#123;</div><div class="line">      <span class="attr">restrict</span>: <span class="string">'EAC'</span>,</div><div class="line">      <span class="attr">template</span>: <span class="string">'&lt;h3&gt;Hello, Angular!&lt;/h3&gt;'</span></div><div class="line">    &#125;</div><div class="line">  &#125;)</div><div class="line">&lt;<span class="regexp">/script&gt;</span></div></pre></td></tr></table></figure>
<p><img src="/images/ng-restrict.png" alt="img"></p>
<hr>
<h3 id="设置指令对象的基础属性"><a href="#设置指令对象的基础属性" class="headerlink" title="设置指令对象的基础属性"></a>设置指令对象的基础属性</h3><p>####templateUrl:它的属性值是一个URL地址，该地址指向一个模板页面</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> myModule = angular.module(<span class="string">"MyModule"</span>, []);</div><div class="line"></div><div class="line"><span class="comment">//注射器加载完所有模块时，此方法执行一次</span></div><div class="line">myModule.run(<span class="function"><span class="keyword">function</span>(<span class="params">$templateCache</span>)</span>&#123;</div><div class="line">  <span class="comment">//把内容缓存起来</span></div><div class="line">	$templateCache.put(<span class="string">"hello.html"</span>,<span class="string">"&lt;div&gt;Hello everyone!!!!!!&lt;/div&gt;"</span>);</div><div class="line">&#125;);</div><div class="line"></div><div class="line">myModule.directive(<span class="string">"hello"</span>, <span class="function"><span class="keyword">function</span>(<span class="params">$templateCache</span>) </span>&#123;</div><div class="line">    <span class="keyword">return</span> &#123;</div><div class="line">        <span class="attr">restrict</span>: <span class="string">'AECM'</span>,</div><div class="line">      <span class="comment">//把缓存取出来</span></div><div class="line">        template: $templateCache.get(<span class="string">"hello.html"</span>),</div><div class="line">        <span class="attr">replace</span>: <span class="literal">true</span></div><div class="line">    &#125;</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<p>####replace开启的话，就会把我们模板里面的内容替换掉</p>
<p>它的属性值是布尔类型，当该属性值为true时，表示用模板中的内容替换指令标记，否则则不替换，直接显示指令标记，默认为false</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"><span class="meta">&lt;!doctype html&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">ng-app</span>=<span class="string">"MyModule"</span>&gt;</span></div><div class="line">	<span class="tag">&lt;<span class="name">head</span>&gt;</span></div><div class="line">		<span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"utf-8"</span>&gt;</span></div><div class="line">	<span class="tag">&lt;/<span class="name">head</span>&gt;</span></div><div class="line">	<span class="tag">&lt;<span class="name">body</span>&gt;</span></div><div class="line">		<span class="tag">&lt;<span class="name">hello</span>&gt;</span></div><div class="line">          //当我们的页面启动后就会把这段内容替换掉</div><div class="line">			<span class="tag">&lt;<span class="name">div</span>&gt;</span>这里是指令内部的内容。<span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">		<span class="tag">&lt;/<span class="name">hello</span>&gt;</span></div><div class="line">	<span class="tag">&lt;/<span class="name">body</span>&gt;</span></div><div class="line">	<span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"framework/angular-1.3.0.14/angular.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></div><div class="line">	<span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"replace.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></div></pre></td></tr></table></figure>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> myModule = angular.module(<span class="string">"MyModule"</span>, []);</div><div class="line">myModule.directive(<span class="string">"hello"</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">    <span class="keyword">return</span> &#123;</div><div class="line">    	<span class="attr">restrict</span>:<span class="string">"AE"</span>,</div><div class="line">    	<span class="attr">template</span>:<span class="string">"&lt;div&gt;Hello everyone!&lt;/div&gt;"</span>,</div><div class="line">    	<span class="attr">replace</span>:<span class="literal">true</span></div><div class="line">    &#125; </div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<p>###Angular指令对象的重要属性</p>
<h4 id="ng-transclude"><a href="#ng-transclude" class="headerlink" title="ng-transclude"></a>ng-transclude</h4><p>只有这个指令可以使用多个指令之间的多层嵌套，所以很重要</p>
<p>属性的值是布尔值，默认为false，表示不开启，如果设置为true，则开启该属性，当开启后，则可以在模板中通过<code>ng-transclude</code>方式替换指令元素中的内容</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&lt;!doctype html&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">ng-app</span>=<span class="string">"MyModule"</span>&gt;</span></div><div class="line">	<span class="tag">&lt;<span class="name">head</span>&gt;</span></div><div class="line">		<span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"utf-8"</span>&gt;</span></div><div class="line">	<span class="tag">&lt;/<span class="name">head</span>&gt;</span></div><div class="line">	<span class="tag">&lt;<span class="name">body</span>&gt;</span></div><div class="line">		<span class="tag">&lt;<span class="name">hello</span>&gt;</span></div><div class="line">			<span class="tag">&lt;<span class="name">div</span>&gt;</span>这里是指令内部的内容。<span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">		<span class="tag">&lt;/<span class="name">hello</span>&gt;</span></div><div class="line">	<span class="tag">&lt;/<span class="name">body</span>&gt;</span></div><div class="line">	<span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"framework/angular-1.3.0.14/angular.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></div><div class="line">	<span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"transclude.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></div></pre></td></tr></table></figure>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> myModule = angular.module(<span class="string">"MyModule"</span>, []);</div><div class="line">myModule.directive(<span class="string">"hello"</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">    <span class="keyword">return</span> &#123;</div><div class="line">    	<span class="attr">restrict</span>:<span class="string">"AE"</span>,</div><div class="line">    	<span class="attr">transclude</span>:<span class="literal">true</span>,</div><div class="line">    	<span class="comment">// ng-transclude告诉angular被替换的内容填充到哪里去</span></div><div class="line">    	template:<span class="string">"&lt;div&gt;Hello everyone!&lt;div ng-transclude&gt;&lt;/div&gt;&lt;/div&gt;"</span></div><div class="line">    &#125; </div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<h4 id="link"><a href="#link" class="headerlink" title="link"></a>link</h4><p>取属性的方式添加监听事件，以及实现指令与多个控制器之间进行交互</p>
<p>指令对象中的<code>link</code>属性的值是一个函数，在该函数中可以操控DOM元素对象，包括绑定元素的各类事件，定义事件触发时执行的内容</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">link: function(scope, element, attrs) &#123;</div><div class="line">  // ...</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p><code>link</code>函数包含3个主要的参数：</p>
<ul>
<li><code>scope</code>参数表示指令所在的作用域</li>
<li><code>element</code>参数表示指令中的元素，改元素可以通过Angular内部封装的jqLite框架进行调用</li>
<li><code>attrs</code>参数表示指令元素的属性集合通过这个参数可以获取元素中的各类属性</li>
</ul>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&lt;!doctype html&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">ng-app</span>=<span class="string">"MyModule"</span>&gt;</span></div><div class="line">	<span class="tag">&lt;<span class="name">head</span>&gt;</span></div><div class="line">		<span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"utf-8"</span>&gt;</span></div><div class="line">	<span class="tag">&lt;/<span class="name">head</span>&gt;</span></div><div class="line">	<span class="tag">&lt;<span class="name">body</span>&gt;</span></div><div class="line">		<span class="tag">&lt;<span class="name">div</span> <span class="attr">ng-controller</span>=<span class="string">"MyCtrl"</span>&gt;</span></div><div class="line">			<span class="tag">&lt;<span class="name">loader</span> <span class="attr">howToLoad</span>=<span class="string">"loadData()"</span>&gt;</span>滑动加载<span class="tag">&lt;/<span class="name">loader</span>&gt;</span></div><div class="line">		<span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">		<span class="tag">&lt;<span class="name">div</span> <span class="attr">ng-controller</span>=<span class="string">"MyCtrl2"</span>&gt;</span></div><div class="line">          //定义属性这样让我们的directive去调用</div><div class="line">			<span class="tag">&lt;<span class="name">loader</span> <span class="attr">howToLoad</span>=<span class="string">"loadData2()"</span>&gt;</span>滑动加载<span class="tag">&lt;/<span class="name">loader</span>&gt;</span></div><div class="line">		<span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">	<span class="tag">&lt;/<span class="name">body</span>&gt;</span></div><div class="line">	<span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"framework/angular-1.3.0.14/angular.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></div><div class="line">	<span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"Directive&amp;Controller.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></div></pre></td></tr></table></figure>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> myModule = angular.module(<span class="string">"MyModule"</span>, []);</div><div class="line">myModule.controller(<span class="string">'MyCtrl'</span>, [<span class="string">'$scope'</span>, <span class="function"><span class="keyword">function</span>(<span class="params">$scope</span>)</span>&#123;</div><div class="line">	$scope.loadData=<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">		<span class="built_in">console</span>.log(<span class="string">"加载数据中..."</span>);</div><div class="line">    &#125;</div><div class="line">&#125;]);</div><div class="line">myModule.controller(<span class="string">'MyCtrl2'</span>, [<span class="string">'$scope'</span>, <span class="function"><span class="keyword">function</span>(<span class="params">$scope</span>)</span>&#123;</div><div class="line">    $scope.loadData2=<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">        <span class="built_in">console</span>.log(<span class="string">"加载数据中...22222"</span>);</div><div class="line">    &#125;</div><div class="line">&#125;]);</div><div class="line">myModule.directive(<span class="string">"loader"</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">    <span class="keyword">return</span> &#123;</div><div class="line">    	<span class="attr">restrict</span>:<span class="string">"AE"</span>,</div><div class="line">    	<span class="attr">link</span>:<span class="function"><span class="keyword">function</span>(<span class="params">scope,element,attrs</span>)</span>&#123;</div><div class="line">          <span class="comment">//这里和jquery一样，给这个loader directive元素添加一个mouseenter事件，然后去调用上面的函数</span></div><div class="line">    		element.bind(<span class="string">'mouseenter'</span>, <span class="function"><span class="keyword">function</span>(<span class="params">event</span>) </span>&#123;</div><div class="line">    			<span class="comment">//scope.loadData();</span></div><div class="line">              <span class="comment">//强制刷新以及调用上面的函数</span></div><div class="line">    			<span class="comment">// scope.$apply("loadData()");</span></div><div class="line">    			<span class="comment">// 注意这里的坑，howToLoad会被转换成小写的howtoload</span></div><div class="line">                <span class="comment">//给我们的页面上的指令加了属性，然后通过不同的属性来调用不同函数，这样子也实现了指令</span></div><div class="line">                <span class="comment">//复用，指令就是为了复用，就可以在不同的控制器中去复用指令，以及实现数据交互</span></div><div class="line">    			scope.$apply(attrs.howtoload);</div><div class="line">    		&#125;);</div><div class="line">        &#125;</div><div class="line">    &#125; </div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<p>link实现多个指令之间的通信</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&lt;!doctype html&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">ng-app</span>=<span class="string">"MyModule"</span>&gt;</span></div><div class="line"></div><div class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"utf-8"</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">"stylesheet"</span> <span class="attr">href</span>=<span class="string">"css/bootstrap-3.0.0/css/bootstrap.css"</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"framework/angular-1.3.0.14/angular.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"Directive&amp;Directive.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></div><div class="line"></div><div class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></div><div class="line">	<span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"row"</span>&gt;</span></div><div class="line">		<span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"col-md-3"</span>&gt;</span></div><div class="line">			<span class="tag">&lt;<span class="name">superman</span> <span class="attr">strength</span>&gt;</span>动感超人---力量<span class="tag">&lt;/<span class="name">superman</span>&gt;</span></div><div class="line">		<span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">	<span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">	<span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"row"</span>&gt;</span></div><div class="line">		<span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"col-md-3"</span>&gt;</span></div><div class="line">			<span class="tag">&lt;<span class="name">superman</span> <span class="attr">strength</span> <span class="attr">speed</span>&gt;</span>动感超人2---力量+敏捷<span class="tag">&lt;/<span class="name">superman</span>&gt;</span></div><div class="line">		<span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">	<span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">	<span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"row"</span>&gt;</span></div><div class="line">		<span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"col-md-3"</span>&gt;</span></div><div class="line">			<span class="tag">&lt;<span class="name">superman</span> <span class="attr">strength</span> <span class="attr">speed</span> <span class="attr">light</span>&gt;</span>动感超人3---力量+敏捷+发光<span class="tag">&lt;/<span class="name">superman</span>&gt;</span></div><div class="line">		<span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">	<span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></div><div class="line"></div><div class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></div></pre></td></tr></table></figure>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> myModule = angular.module(<span class="string">"MyModule"</span>, []);</div><div class="line">myModule.directive(<span class="string">"superman"</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">    <span class="keyword">return</span> &#123;</div><div class="line">      <span class="comment">//创建独立作用域，下面一个例子会讲解独立scope</span></div><div class="line">        scope: &#123;&#125;,</div><div class="line">        <span class="attr">restrict</span>: <span class="string">'AE'</span>,</div><div class="line">      <span class="comment">//指令内部的controller，作用是我们的指令暴露出public方法供外部使用</span></div><div class="line">        controller: <span class="function"><span class="keyword">function</span>(<span class="params">$scope</span>) </span>&#123;</div><div class="line">            $scope.abilities = [];</div><div class="line">            <span class="keyword">this</span>.addStrength = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">                $scope.abilities.push(<span class="string">"strength"</span>);</div><div class="line">            &#125;;</div><div class="line">            <span class="keyword">this</span>.addSpeed = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">                $scope.abilities.push(<span class="string">"speed"</span>);</div><div class="line">            &#125;;</div><div class="line">            <span class="keyword">this</span>.addLight = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">                $scope.abilities.push(<span class="string">"light"</span>);</div><div class="line">            &#125;;</div><div class="line">        &#125;,</div><div class="line">      <span class="comment">//link是指令内部的一些方法</span></div><div class="line">        link: <span class="function"><span class="keyword">function</span>(<span class="params">scope, element, attrs</span>) </span>&#123;</div><div class="line">          <span class="comment">//给我们的元素增加classname</span></div><div class="line">            element.addClass(<span class="string">'btn btn-primary'</span>);</div><div class="line">          <span class="comment">//绑定事件</span></div><div class="line">            element.bind(<span class="string">"mouseenter"</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">                <span class="built_in">console</span>.log(scope.abilities);</div><div class="line">            &#125;);</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;);</div><div class="line">myModule.directive(<span class="string">"strength"</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">    <span class="keyword">return</span> &#123;</div><div class="line">      <span class="comment">//require是说strength指令依赖于superman这个指令</span></div><div class="line">        <span class="built_in">require</span>: <span class="string">'^superman'</span>,</div><div class="line">      <span class="comment">//当有了依赖之后，我们就可以注入第四个参数了，这样子我们就可以访问到supermanCtrl里面暴露出来的公用方法了</span></div><div class="line">        link: <span class="function"><span class="keyword">function</span>(<span class="params">scope, element, attrs, supermanCtrl</span>) </span>&#123;</div><div class="line">            supermanCtrl.addStrength();</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;);</div><div class="line">myModule.directive(<span class="string">"speed"</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">    <span class="keyword">return</span> &#123;</div><div class="line">        <span class="attr">require</span>: <span class="string">'^superman'</span>,</div><div class="line">        <span class="attr">link</span>: <span class="function"><span class="keyword">function</span>(<span class="params">scope, element, attrs, supermanCtrl</span>) </span>&#123;</div><div class="line">            supermanCtrl.addSpeed();</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;);</div><div class="line">myModule.directive(<span class="string">"light"</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">    <span class="keyword">return</span> &#123;</div><div class="line">        <span class="attr">require</span>: <span class="string">'^superman'</span>,</div><div class="line">        <span class="attr">link</span>: <span class="function"><span class="keyword">function</span>(<span class="params">scope, element, attrs, supermanCtrl</span>) </span>&#123;</div><div class="line">            supermanCtrl.addLight();</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<p>####独立scope</p>
<p>在Angular指令对象中，<code>scope</code>属性使用频率很高，它的值包含两种类型，一种是布尔值，另一类是JSON对象</p>
<p>#####scope属性是布尔值</p>
<p>使用<code>scope</code>属性自定义指令时，默认是布尔类型，初始值为false。在这种情况下，指令中的作用域就是指令元素所在的作用域。我们将指令中的作用域称为子作用域，把指令元素所在作用域称为父作用域，当<code>scope</code>为<code>false</code>时，子作用域和父作用域完全相同，一方变化，则另一方也会自动发生变化</p>
<p>当<code>scope</code>为<code>true</code>时，则表示子作用域是独立创建的，父作用域中内容的改变会影响子作用域，但子作用域的内容发生变化，并不会修改父作用域中的内容</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div></pre></td><td class="code"><pre><div class="line">&lt;script type="text/ng-template" id="tpl"&gt;</div><div class="line">  &lt;div&gt;&#123;&#123;message&#125;&#125;&lt;/div&gt;</div><div class="line">  &lt;button ng-transclude&gt;&lt;/button&gt;</div><div class="line">&lt;/script&gt;</div><div class="line"></div><div class="line">&lt;div&gt;</div><div class="line">  &lt;input type="text" ng-model="message" placeholder="请输入提示内容"&gt;</div><div class="line">  &lt;ts-message&gt;固定&lt;/ts-message&gt;</div><div class="line">&lt;/div&gt;</div><div class="line"></div><div class="line">&lt;script&gt;</div><div class="line">  var app = angular.module('myapp', []);</div><div class="line">  app.directive('tsMessage', function () &#123;</div><div class="line">    return &#123;</div><div class="line">      restrict: 'EAC',</div><div class="line">      templateUrl: 'tpl',</div><div class="line">      transclude: true,</div><div class="line">      scope: true,</div><div class="line">      link: function (scope, element, attrs) &#123;</div><div class="line">        element.bind('click', function () &#123;</div><div class="line">          scope.$apply(function () &#123;</div><div class="line">            scope.message = '这是单击后的值';</div><div class="line">          &#125;)</div><div class="line">        &#125;)</div><div class="line">      &#125;</div><div class="line">    &#125;</div><div class="line">  &#125;)</div><div class="line">&lt;/script&gt;</div></pre></td></tr></table></figure>
<p>第二个例子</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">ng-controller</span>=<span class="string">"myCtrl"</span>&gt;</span></div><div class="line">  父亲: &#123;&#123;name&#125;&#125;</div><div class="line">  <span class="tag">&lt;<span class="name">input</span> <span class="attr">ng-model</span>=<span class="string">"name"</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">my-directive</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></div></pre></td></tr></table></figure>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> app = angular.module(<span class="string">'myApp'</span>, [])</div><div class="line">  app.controller(<span class="string">'myCtrl'</span>, [<span class="string">'$scope'</span>, <span class="function"><span class="keyword">function</span> (<span class="params">$scope</span>) </span>&#123;</div><div class="line">    $scope.name = <span class="string">'leifeng'</span>;</div><div class="line">  &#125;]);</div><div class="line">  app.directive(<span class="string">'myDirective'</span>, <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">    <span class="keyword">return</span> &#123;</div><div class="line">      <span class="attr">restrict</span>: <span class="string">'EA'</span>,</div><div class="line">      <span class="attr">scope</span>: <span class="literal">true</span>,    <span class="comment">//父作用域发生改变，子作用域会变化，子作用域的变化不会影响父作用域</span></div><div class="line">      template: <span class="string">'&lt;div&gt;儿子: &#123;&#123;name&#125;&#125;&lt;input ng-model="name"&gt;&lt;/div&gt;'</span></div><div class="line">    &#125;</div><div class="line">  &#125;);</div></pre></td></tr></table></figure>
<p>#####scope属性是对象</p>
<p>除了将scope属性设置为布尔值之外，还可以设置成一个JSON对象，如果是对象，那么父作用域与子作用域是完全独立的，不存在任何关联</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">app.directive(&apos;myDirective&apos;, function () &#123;</div><div class="line">  return &#123;</div><div class="line">    resrict: &apos;EA&apos;,</div><div class="line">    scope: &#123;&#125;,  //父作用域与子作用域相互不影响，改变任意一方都不会改变另一方</div><div class="line">    template: //....</div><div class="line">  &#125;</div><div class="line">&#125;)</div></pre></td></tr></table></figure>
<p>这时，子作用域中如果需要添加属性，则可以通过<code>link</code>函数，在<code>scope</code>上添加，如果子作用域需要与调用父作用域的属性和方法，则需要在这个JSON对象中添加绑定策略</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&lt;!doctype html&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">ng-app</span>=<span class="string">"MyModule"</span>&gt;</span></div><div class="line">	<span class="tag">&lt;<span class="name">head</span>&gt;</span></div><div class="line">		<span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"utf-8"</span>&gt;</span></div><div class="line">		<span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">"stylesheet"</span> <span class="attr">href</span>=<span class="string">"css/bootstrap-3.0.0/css/bootstrap.css"</span>&gt;</span></div><div class="line">	<span class="tag">&lt;/<span class="name">head</span>&gt;</span></div><div class="line">	<span class="tag">&lt;<span class="name">body</span>&gt;</span></div><div class="line">		<span class="tag">&lt;<span class="name">hello</span>&gt;</span><span class="tag">&lt;/<span class="name">hello</span>&gt;</span></div><div class="line">		<span class="tag">&lt;<span class="name">hello</span>&gt;</span><span class="tag">&lt;/<span class="name">hello</span>&gt;</span></div><div class="line">		<span class="tag">&lt;<span class="name">hello</span>&gt;</span><span class="tag">&lt;/<span class="name">hello</span>&gt;</span></div><div class="line">		<span class="tag">&lt;<span class="name">hello</span>&gt;</span><span class="tag">&lt;/<span class="name">hello</span>&gt;</span></div><div class="line">	<span class="tag">&lt;/<span class="name">body</span>&gt;</span></div><div class="line">	<span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"framework/angular-1.3.0.14/angular.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></div><div class="line">	<span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"IsolateScope.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></div></pre></td></tr></table></figure>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> myModule = angular.module(<span class="string">"MyModule"</span>, []);</div><div class="line">myModule.directive(<span class="string">"hello"</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">    <span class="keyword">return</span> &#123;</div><div class="line">        <span class="attr">restrict</span>: <span class="string">'AE'</span>,</div><div class="line">       <span class="comment">// scope:&#123;&#125;,// 如果不加这个参数的话，我们页面中所有的指令都会同时发生改变互相影响，这显然是不是我们想要的</span></div><div class="line">        template: <span class="string">'&lt;div&gt;&lt;input type="text" ng-model="userName"/&gt;&#123;&#123;userName&#125;&#125;&lt;/div&gt;'</span>,</div><div class="line">        <span class="attr">replace</span>: <span class="literal">true</span></div><div class="line">    &#125;</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<h5 id="scope绑定策略"><a href="#scope绑定策略" class="headerlink" title="scope绑定策略"></a>scope绑定策略</h5><p>在JSON对象中添加的有3种绑定策略，分别是<code>@</code>、<code>=</code>和<code>&amp;</code></p>
<p><img src="/images/ng-scope.png" alt="img"></p>
<p>@绑定</p>
<p>如果父作用域的属性内容修改了，子作用域对应的属性内容也会随之修改，而如果子作用域属性内容修改了，是不会影响父作用域对应的属性内容的。</p>
<p>案例一</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">ng-controller</span>=<span class="string">"myCtrl"</span>&gt;</span></div><div class="line">  父亲: &#123;&#123;name&#125;&#125;</div><div class="line">  <span class="tag">&lt;<span class="name">input</span> <span class="attr">ng-model</span>=<span class="string">"name"</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">my-directive</span> <span class="attr">name</span>=<span class="string">"&#123;&#123;name&#125;&#125;"</span>&gt;</span><span class="tag">&lt;/<span class="name">my-directive</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></div></pre></td></tr></table></figure>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line">&lt;script&gt;</div><div class="line">  <span class="keyword">var</span> app = angular.module(<span class="string">'myApp'</span>, [])</div><div class="line">  app.controller(<span class="string">'myCtrl'</span>, [<span class="string">'$scope'</span>, <span class="function"><span class="keyword">function</span> (<span class="params">$scope</span>) </span>&#123;</div><div class="line"></div><div class="line">  &#125;]);</div><div class="line">  app.directive(<span class="string">'myDirective'</span>, <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">    <span class="keyword">return</span> &#123;</div><div class="line">      <span class="attr">restrict</span>: <span class="string">'EA'</span>,</div><div class="line">      <span class="attr">scope</span>: &#123;</div><div class="line">        <span class="attr">name</span>: <span class="string">'@'</span>  <span class="comment">//指令作用域中变量与父作用域中一致，直接使用@绑定</span></div><div class="line">      &#125;,</div><div class="line">      <span class="attr">replace</span>: <span class="literal">true</span>,</div><div class="line">      <span class="attr">template</span>: <span class="string">'&lt;div&gt;儿子: &#123;&#123;name&#125;&#125;&lt;input ng-model="name"&gt;&lt;/div&gt;'</span></div><div class="line">    &#125;</div><div class="line">  &#125;);</div><div class="line"><span class="xml"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></div></pre></td></tr></table></figure>
<p>案例二</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&lt;!doctype html&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">ng-app</span>=<span class="string">"MyModule"</span>&gt;</span></div><div class="line">	<span class="tag">&lt;<span class="name">head</span>&gt;</span></div><div class="line">		<span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"utf-8"</span>&gt;</span></div><div class="line">		<span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">"stylesheet"</span> <span class="attr">href</span>=<span class="string">"css/bootstrap-3.0.0/css/bootstrap.css"</span>&gt;</span></div><div class="line">	<span class="tag">&lt;/<span class="name">head</span>&gt;</span></div><div class="line">	<span class="tag">&lt;<span class="name">body</span>&gt;</span></div><div class="line">		<span class="tag">&lt;<span class="name">div</span> <span class="attr">ng-controller</span>=<span class="string">"MyCtrl"</span>&gt;</span></div><div class="line">          //需要注意的是@绑定传递的是字符串，而不是对象</div><div class="line">			<span class="tag">&lt;<span class="name">drink</span> <span class="attr">flavor</span>=<span class="string">"&#123;&#123;ctrlFlavor&#125;&#125;"</span>&gt;</span><span class="tag">&lt;/<span class="name">drink</span>&gt;</span></div><div class="line">		<span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">	<span class="tag">&lt;/<span class="name">body</span>&gt;</span></div><div class="line">	<span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"framework/angular-1.3.0.14/angular.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></div><div class="line">	<span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"ScopeAt.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></div></pre></td></tr></table></figure>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> myModule = angular.module(<span class="string">"MyModule"</span>, []);</div><div class="line">myModule.controller(<span class="string">'MyCtrl'</span>, [<span class="string">'$scope'</span>, <span class="function"><span class="keyword">function</span>(<span class="params">$scope</span>)</span>&#123;</div><div class="line">  <span class="comment">//控制器上面加个一个属性</span></div><div class="line">	$scope.ctrlFlavor=<span class="string">"百威"</span>;</div><div class="line">&#125;])</div><div class="line">myModule.directive(<span class="string">"drink"</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">    <span class="keyword">return</span> &#123;</div><div class="line">    	<span class="attr">restrict</span>:<span class="string">'AE'</span>,</div><div class="line">        <span class="attr">scope</span>:&#123;</div><div class="line">          <span class="comment">//而这种方式angular则会帮我们自动绑定数据</span></div><div class="line">        	flavor:<span class="string">'@'</span></div><div class="line">        &#125;,</div><div class="line">        <span class="attr">template</span>:<span class="string">"&lt;div&gt;&#123;&#123;flavor&#125;&#125;&lt;/div&gt;"</span></div><div class="line">        <span class="comment">// ,</span></div><div class="line">      <span class="comment">//下面这种方式指定我们的flavor的数据是我们的控制器中的数据</span></div><div class="line">        <span class="comment">// link:function(scope,element,attrs)&#123;</span></div><div class="line">        <span class="comment">// 	scope.flavor=attrs.flavor;</span></div><div class="line">        <span class="comment">// &#125;</span></div><div class="line">    &#125;</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<p>ScopeEqual绑定 进行双向数据绑定，也就是我们控制器与指令之间进行双向的数据绑定</p>
<p><code>=绑定</code>的功能是创建一个父作用域与子作用域可以同时共享的属性，即父作用域修改了该属性，子作用域也随之改变，反之亦然。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&lt;!doctype html&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">ng-app</span>=<span class="string">"MyModule"</span>&gt;</span></div><div class="line">	<span class="tag">&lt;<span class="name">head</span>&gt;</span></div><div class="line">		<span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"utf-8"</span>&gt;</span></div><div class="line">		<span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">"stylesheet"</span> <span class="attr">href</span>=<span class="string">"css/bootstrap-3.0.0/css/bootstrap.css"</span>&gt;</span></div><div class="line">	<span class="tag">&lt;/<span class="name">head</span>&gt;</span></div><div class="line">	<span class="tag">&lt;<span class="name">body</span>&gt;</span></div><div class="line">		<span class="tag">&lt;<span class="name">div</span> <span class="attr">ng-controller</span>=<span class="string">"MyCtrl"</span>&gt;</span></div><div class="line">			Ctrl:</div><div class="line">			<span class="tag">&lt;<span class="name">br</span>&gt;</span></div><div class="line">          //这儿是我们控制器中的ctrlFlavor</div><div class="line">			<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">ng-model</span>=<span class="string">"ctrlFlavor"</span>&gt;</span></div><div class="line">			<span class="tag">&lt;<span class="name">br</span>&gt;</span></div><div class="line">			Directive:</div><div class="line">			<span class="tag">&lt;<span class="name">br</span>&gt;</span></div><div class="line">          //这儿展示我们指令中的flavor</div><div class="line">			<span class="tag">&lt;<span class="name">drink</span> <span class="attr">flavor</span>=<span class="string">"ctrlFlavor"</span>&gt;</span><span class="tag">&lt;/<span class="name">drink</span>&gt;</span></div><div class="line">		<span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">	<span class="tag">&lt;/<span class="name">body</span>&gt;</span></div><div class="line">	<span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"framework/angular-1.3.0.14/angular.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></div><div class="line">	<span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"ScopeEqual.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></div></pre></td></tr></table></figure>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> myModule = angular.module(<span class="string">"MyModule"</span>, []);</div><div class="line">myModule.controller(<span class="string">'MyCtrl'</span>, [<span class="string">'$scope'</span>, <span class="function"><span class="keyword">function</span>(<span class="params">$scope</span>)</span>&#123;</div><div class="line">	$scope.ctrlFlavor=<span class="string">"百威"</span>;</div><div class="line">&#125;])</div><div class="line">myModule.directive(<span class="string">"drink"</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">    <span class="keyword">return</span> &#123;</div><div class="line">    	<span class="attr">restrict</span>:<span class="string">'AE'</span>,</div><div class="line">        <span class="attr">scope</span>:&#123;</div><div class="line">          <span class="comment">//用=绑定就可以只要改变我们指令中的flavor就可以改变我们的控制器中的ctrlFlavor，反之我们改变控制器中的也可以改变指令中的</span></div><div class="line">        	flavor:<span class="string">'='</span></div><div class="line">        &#125;,</div><div class="line">        <span class="attr">template</span>:<span class="string">'&lt;input type="text" ng-model="flavor"/&gt;'</span></div><div class="line">    &#125;</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<p>&amp;scope  实现控制器与指令之间的交互，比<code>link</code>要方便,传递一个来自父scope的函数，稍后调用</p>
<p><code>&amp;绑定</code>的功能可以在独立的子作用域中直接调用父作用域的方法，在调用时可以向函数传递参数。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&lt;!doctype html&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">ng-app</span>=<span class="string">"MyModule"</span>&gt;</span></div><div class="line">	<span class="tag">&lt;<span class="name">head</span>&gt;</span></div><div class="line">		<span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"utf-8"</span>&gt;</span></div><div class="line">		<span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">"stylesheet"</span> <span class="attr">href</span>=<span class="string">"css/bootstrap-3.0.0/css/bootstrap.css"</span>&gt;</span></div><div class="line">	<span class="tag">&lt;/<span class="name">head</span>&gt;</span></div><div class="line">	<span class="tag">&lt;<span class="name">body</span>&gt;</span></div><div class="line">		<span class="tag">&lt;<span class="name">div</span> <span class="attr">ng-controller</span>=<span class="string">"MyCtrl"</span>&gt;</span></div><div class="line">          //这里我们传递的参数是对象，跟上面说的@scope不同</div><div class="line">			<span class="tag">&lt;<span class="name">greeting</span> <span class="attr">greet</span>=<span class="string">"sayHello(name)"</span>&gt;</span><span class="tag">&lt;/<span class="name">greeting</span>&gt;</span></div><div class="line">			<span class="tag">&lt;<span class="name">greeting</span> <span class="attr">greet</span>=<span class="string">"sayHello(name)"</span>&gt;</span><span class="tag">&lt;/<span class="name">greeting</span>&gt;</span></div><div class="line">			<span class="tag">&lt;<span class="name">greeting</span> <span class="attr">greet</span>=<span class="string">"sayHello(name)"</span>&gt;</span><span class="tag">&lt;/<span class="name">greeting</span>&gt;</span></div><div class="line">		<span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">	<span class="tag">&lt;/<span class="name">body</span>&gt;</span></div><div class="line">	<span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"framework/angular-1.3.0.14/angular.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></div><div class="line">	<span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"ScopeAnd.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></div></pre></td></tr></table></figure>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> myModule = angular.module(<span class="string">"MyModule"</span>, [] ;</div><div class="line">myModule.controller(<span class="string">'MyCtrl'</span>, [<span class="string">'$scope'</span>, <span class="function"><span class="keyword">function</span>(<span class="params">$scope</span>)</span>&#123;</div><div class="line">  <span class="comment">//暴露出一个方法就可以被我们的指令进行调用</span></div><div class="line">	$scope.sayHello=<span class="function"><span class="keyword">function</span>(<span class="params">name</span>)</span>&#123;</div><div class="line">		alert(<span class="string">"Hello "</span>+name);</div><div class="line">	&#125;</div><div class="line">&#125;])</div><div class="line">myModule.directive(<span class="string">"greeting"</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">    <span class="keyword">return</span> &#123;</div><div class="line">    	<span class="attr">restrict</span>:<span class="string">'AE'</span>,</div><div class="line">        <span class="attr">scope</span>:&#123;</div><div class="line">        	<span class="attr">greet</span>:<span class="string">'&amp;'</span></div><div class="line">        &#125;,</div><div class="line">      <span class="comment">//在下面我们添加一个方法进行调用我们上面的控制器暴露出来的sayHello方法</span></div><div class="line">      <span class="comment">//传递参数的形式是对象的形式</span></div><div class="line">        template:<span class="string">'&lt;input type="text" ng-model="userName" /&gt;&lt;br/&gt;'</span>+</div><div class="line">        		 <span class="string">'&lt;button class="btn btn-default" ng-click="greet(&#123;name:userName&#125;)"&gt;Greeting&lt;/button&gt;&lt;br/&gt;'</span></div><div class="line">    &#125;</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<h3 id="Angular指令对象的require和controller属性"><a href="#Angular指令对象的require和controller属性" class="headerlink" title="Angular指令对象的require和controller属性"></a>Angular指令对象的require和controller属性</h3><p><code>require</code>和<code>controller</code>两个属性常用于多个自定义指令元素嵌套时，即当一个子元素指令需要与父元素指令通信时，就需要使用这两个属性</p>
<h4 id="require和controller属性的概念"><a href="#require和controller属性的概念" class="headerlink" title="require和controller属性的概念"></a>require和controller属性的概念</h4><p><code>require</code>属性在创建子元素指令时添加，它的属性值用于描述与父元素指令通信时的方式，如<code>^</code>符号表示向外层寻找指定名称的指令，<code>?</code>符号表示即使没有找到，也不会出现异常</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">require: &quot;^?myDirective&quot;</div></pre></td></tr></table></figure>
<p><code>controller</code>属性值是一个构造函数，在创建父元素指令时添加，并可以在函数中创建多个属性或方法。在添加后，这些属性和方法都会被实例的对象所继承，而这个实例对象则是子元素指令中<code>link</code>函数的第4个参数</p>
<p>也就是说，当在子元素指令中添加了<code>require</code>属性，并通过属性值指定父元素指令的名称，那么就可以通过子元素指令中<code>link</code>函数的第4个参数来访问父元素指令中<code>controller</code>属性添加的方法。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">controller: function () &#123;</div><div class="line">  this.a = function (childDirective) &#123;</div><div class="line">    // 方法a的函数体</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<ul>
<li><code>controller</code>的属性值对应一个构造函数</li>
<li><code>this</code>代表父元素指令本身</li>
<li><code>a</code>表示构造函数中的一个任意的方法</li>
<li><code>childDirective</code>形参表示子元素指令中的<code>scope</code>对象</li>
</ul>
<p>html:</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">div</span>&gt;</span></div><div class="line">  <span class="comment">&lt;!--父元素指令--&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">ts-parent</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">div</span>&gt;</span>&#123;&#123;ptip&#125;&#125;<span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">    <span class="comment">&lt;!--子元素指令--&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">ts-child</span>&gt;</span></div><div class="line">      <span class="tag">&lt;<span class="name">div</span>&gt;</span>&#123;&#123;ctip&#125;&#125;<span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">    <span class="tag">&lt;/<span class="name">ts-child</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">button</span> <span class="attr">ng-click</span>=<span class="string">"click()"</span>&gt;</span>换位<span class="tag">&lt;/<span class="name">button</span>&gt;</span></div><div class="line">  <span class="tag">&lt;/<span class="name">ts-parent</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></div></pre></td></tr></table></figure>
<p>javascript:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div></pre></td><td class="code"><pre><div class="line">&lt;script&gt;</div><div class="line">  <span class="keyword">var</span> app = angular.module(<span class="string">'myApp'</span>, []);</div><div class="line"></div><div class="line">  app.directive(<span class="string">'tsParent'</span>, <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">    <span class="keyword">return</span> &#123;</div><div class="line">      <span class="attr">restrict</span>: <span class="string">'EA'</span>,</div><div class="line">      <span class="attr">controller</span>: <span class="function"><span class="keyword">function</span> (<span class="params">$scope, $compile, $http</span>) </span>&#123;</div><div class="line">        <span class="keyword">this</span>.addChild = <span class="function"><span class="keyword">function</span> (<span class="params">c</span>) </span>&#123;</div><div class="line">          $scope.ptip = <span class="string">'今天天气不错!'</span>;</div><div class="line">          $scope.click = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">            $scope.tmp = $scope.ptip;</div><div class="line">            $scope.ptip = c.ctip;</div><div class="line">            c.ctip = $scope.tmp;</div><div class="line">          &#125;</div><div class="line">        &#125;</div><div class="line">      &#125;</div><div class="line">    &#125;</div><div class="line">  &#125;);</div><div class="line"></div><div class="line">  app.directive(<span class="string">'tsChild'</span>, <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">    <span class="keyword">return</span> &#123;</div><div class="line">      <span class="attr">restrict</span>: <span class="string">'EA'</span>,</div><div class="line">      <span class="comment">// 与父元素指令tsParent进行通信</span></div><div class="line">      <span class="built_in">require</span>: <span class="string">'^?tsParent'</span>,</div><div class="line">      <span class="comment">// 第4个参数表示父元素指令本身，可以调用定义在其上的方法</span></div><div class="line">      link: <span class="function"><span class="keyword">function</span> (<span class="params">scope, element, attrs, ctrl</span>) </span>&#123;</div><div class="line">        scope.ctip = <span class="string">'气温正好18摄氏度'</span>;</div><div class="line">        ctrl.addChild(scope);</div><div class="line">      &#125;</div><div class="line">    &#125;</div><div class="line">  &#125;);</div><div class="line"><span class="xml"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></div></pre></td></tr></table></figure>
<p>angular内置指令在我用的1.3.11中共计63个</p>
<p><img src="/images/ng-zhiling.png" alt="img"></p>
<h5 id="form指令"><a href="#form指令" class="headerlink" title="form指令"></a>form指令</h5><p><img src="/images/ng-form.png" alt="img"></p>
<p>FormBasic</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">ng-app</span>=<span class="string">'TestFormModule'</span>&gt;</span></div><div class="line">	<span class="tag">&lt;<span class="name">head</span>&gt;</span></div><div class="line">		<span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">"content-type"</span> <span class="attr">content</span>=<span class="string">"text/html; charset=utf-8"</span> /&gt;</span></div><div class="line">		<span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"framework/angular-1.3.0.14/angular.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></div><div class="line">		<span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"FormBasic.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></div><div class="line">	<span class="tag">&lt;/<span class="name">head</span>&gt;</span></div><div class="line">	<span class="tag">&lt;<span class="name">body</span>&gt;</span></div><div class="line">		<span class="tag">&lt;<span class="name">form</span> <span class="attr">name</span>=<span class="string">"myForm"</span> <span class="attr">ng-submit</span>=<span class="string">"save()"</span> <span class="attr">ng-controller</span>=<span class="string">"TestFormModule"</span>&gt;</span></div><div class="line">          //required属性就是我们的angular帮我们自动校验</div><div class="line">			  <span class="tag">&lt;<span class="name">input</span> <span class="attr">name</span>=<span class="string">"userName"</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">ng-model</span>=<span class="string">"user.userName"</span> <span class="attr">required</span>/&gt;</span></div><div class="line">			  <span class="tag">&lt;<span class="name">input</span> <span class="attr">name</span>=<span class="string">"password"</span> <span class="attr">type</span>=<span class="string">"password"</span> <span class="attr">ng-model</span>=<span class="string">"user.password"</span> <span class="attr">required</span>/&gt;</span></div><div class="line">          //ng-disabled把它绑定到myForm.$invalid上就可以判断我们的按钮是否可用的状态</div><div class="line">			  <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"submit"</span> <span class="attr">ng-disabled</span>=<span class="string">"myForm.$invalid"</span>/&gt;</span></div><div class="line">		<span class="tag">&lt;/<span class="name">form</span>&gt;</span></div><div class="line">	<span class="tag">&lt;/<span class="name">body</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></div></pre></td></tr></table></figure>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> appModule = angular.module(<span class="string">'TestFormModule'</span>, []);</div><div class="line">appModule.controller(<span class="string">"TestFormModule"</span>,<span class="function"><span class="keyword">function</span>(<span class="params">$scope</span>)</span>&#123;</div><div class="line">	$scope.user=&#123;</div><div class="line">		<span class="attr">userName</span>:<span class="string">'damoqiongqiu'</span>,</div><div class="line">		<span class="attr">password</span>:<span class="string">''</span></div><div class="line">	&#125;;</div><div class="line">	$scope.save=<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">		alert(<span class="string">"保存数据!"</span>);</div><div class="line">	&#125;</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<p>formadv1 下面是复杂一点的表单</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&lt;!doctype html&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">ng-app</span>&gt;</span></div><div class="line">	<span class="tag">&lt;<span class="name">head</span>&gt;</span></div><div class="line">		<span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"framework/angular-1.3.0.14/angular.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></div><div class="line">		<span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"FormAdv1.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></div><div class="line">	<span class="tag">&lt;/<span class="name">head</span>&gt;</span></div><div class="line">	<span class="tag">&lt;<span class="name">body</span>&gt;</span></div><div class="line">		<span class="tag">&lt;<span class="name">div</span> <span class="attr">ng-controller</span>=<span class="string">"Controller"</span>&gt;</span></div><div class="line">			<span class="tag">&lt;<span class="name">form</span> <span class="attr">name</span>=<span class="string">"form"</span> <span class="attr">class</span>=<span class="string">"css-form"</span> <span class="attr">novalidate</span>&gt;</span></div><div class="line">				Name:</div><div class="line">				<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">ng-model</span>=<span class="string">"user.name"</span> <span class="attr">name</span>=<span class="string">"uName"</span> <span class="attr">required</span> /&gt;</span><span class="tag">&lt;<span class="name">br</span>/&gt;</span></div><div class="line">				E-mail:</div><div class="line">				<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"email"</span> <span class="attr">ng-model</span>=<span class="string">"user.email"</span> <span class="attr">name</span>=<span class="string">"uEmail"</span> <span class="attr">required</span> /&gt;</span><span class="tag">&lt;<span class="name">br</span>/&gt;</span></div><div class="line">              //校验我们的Email是否合法form.uEmail.$dirty &amp;&amp; form.uEmail.$invalid</div><div class="line">				<span class="tag">&lt;<span class="name">div</span> <span class="attr">ng-show</span>=<span class="string">"form.uEmail.$dirty &amp;&amp; form.uEmail.$invalid"</span>&gt;</span></div><div class="line">					Invalid:</div><div class="line">					<span class="tag">&lt;<span class="name">span</span> <span class="attr">ng-show</span>=<span class="string">"form.uEmail.$error.required"</span>&gt;</span>Tell us your email.<span class="tag">&lt;/<span class="name">span</span>&gt;</span></div><div class="line">					<span class="tag">&lt;<span class="name">span</span> <span class="attr">ng-show</span>=<span class="string">"form.uEmail.$error.email"</span>&gt;</span>This is not a valid email.<span class="tag">&lt;/<span class="name">span</span>&gt;</span></div><div class="line">				<span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">				Gender:<span class="tag">&lt;<span class="name">br</span>/&gt;</span></div><div class="line">				<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"radio"</span> <span class="attr">ng-model</span>=<span class="string">"user.gender"</span> <span class="attr">value</span>=<span class="string">"male"</span> /&gt;</span></div><div class="line">				male</div><div class="line">				<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"radio"</span> <span class="attr">ng-model</span>=<span class="string">"user.gender"</span> <span class="attr">value</span>=<span class="string">"female"</span> /&gt;</span></div><div class="line">				female<span class="tag">&lt;<span class="name">br</span>/&gt;</span></div><div class="line">				<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"checkbox"</span> <span class="attr">ng-model</span>=<span class="string">"user.agree"</span> <span class="attr">name</span>=<span class="string">"userAgree"</span> <span class="attr">required</span> /&gt;</span></div><div class="line">				I agree:</div><div class="line">				<span class="tag">&lt;<span class="name">input</span> <span class="attr">ng-show</span>=<span class="string">"user.agree"</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">ng-model</span>=<span class="string">"user.agreeSign"</span> <span class="attr">required</span> /&gt;</span></div><div class="line">				<span class="tag">&lt;<span class="name">div</span> <span class="attr">ng-show</span>=<span class="string">"!user.agree || !user.agreeSign"</span>&gt;</span></div><div class="line">					Please agree and sign.</div><div class="line">				<span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">				<span class="tag">&lt;<span class="name">br</span>/&gt;</span></div><div class="line">				<span class="tag">&lt;<span class="name">button</span> <span class="attr">ng-click</span>=<span class="string">"reset()"</span> <span class="attr">ng-disabled</span>=<span class="string">"isUnchanged(user)"</span>&gt;</span></div><div class="line">					RESET</div><div class="line">				<span class="tag">&lt;/<span class="name">button</span>&gt;</span></div><div class="line">				<span class="tag">&lt;<span class="name">button</span> <span class="attr">ng-click</span>=<span class="string">"update(user)"</span> <span class="attr">ng-disabled</span>=<span class="string">"form.$invalid || isUnchanged(user)"</span>&gt;</span></div><div class="line">					SAVE</div><div class="line">				<span class="tag">&lt;/<span class="name">button</span>&gt;</span></div><div class="line">			<span class="tag">&lt;/<span class="name">form</span>&gt;</span></div><div class="line">		<span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">	<span class="tag">&lt;/<span class="name">body</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></div></pre></td></tr></table></figure>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">Controller</span>(<span class="params">$scope</span>) </span>&#123;</div><div class="line">	$scope.master = &#123;&#125;;</div><div class="line"></div><div class="line">	$scope.update = <span class="function"><span class="keyword">function</span>(<span class="params">user</span>) </span>&#123;</div><div class="line">		$scope.master = angular.copy(user);</div><div class="line">	&#125;;</div><div class="line"></div><div class="line">	$scope.reset = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">		$scope.user = angular.copy($scope.master);</div><div class="line">	&#125;;</div><div class="line"></div><div class="line">	$scope.isUnchanged = <span class="function"><span class="keyword">function</span>(<span class="params">user</span>) </span>&#123;</div><div class="line">		<span class="keyword">return</span> angular.equals(user, $scope.master);</div><div class="line">	&#125;;</div><div class="line"></div><div class="line">	$scope.reset();</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>下面说一个比较酷的功能</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&lt;!doctype html&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">ng-app</span>=<span class="string">"form-example2"</span>&gt;</span></div><div class="line">	<span class="tag">&lt;<span class="name">head</span>&gt;</span></div><div class="line">		<span class="tag">&lt;<span class="name">link</span> <span class="attr">href</span>=<span class="string">"../bootstrap/css/bootstrap.min.css"</span> <span class="attr">rel</span>=<span class="string">"stylesheet"</span> <span class="attr">media</span>=<span class="string">"screen"</span>&gt;</span></div><div class="line">		<span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"framework/angular-1.3.0.14/angular.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></div><div class="line">		<span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"FormCustom.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></div><div class="line">		<span class="tag">&lt;<span class="name">style</span> <span class="attr">type</span>=<span class="string">"text/css"</span>&gt;</span><span class="undefined"></span></div><div class="line">			div[contentEditable] &#123;</div><div class="line">				cursor: pointer;</div><div class="line">				background-color: #D0D0D0;</div><div class="line">			&#125;</div><div class="line">		<span class="tag">&lt;/<span class="name">style</span>&gt;</span></div><div class="line">	<span class="tag">&lt;/<span class="name">head</span>&gt;</span></div><div class="line">	<span class="tag">&lt;<span class="name">body</span>&gt;</span></div><div class="line">		<span class="tag">&lt;<span class="name">div</span>&gt;</span></div><div class="line">          //开启contentEditable可以让我们的div有input的功能</div><div class="line">			<span class="tag">&lt;<span class="name">div</span> <span class="attr">contentEditable</span>=<span class="string">"true"</span> <span class="attr">ng-model</span>=<span class="string">"content"</span> <span class="attr">title</span>=<span class="string">"Click to edit"</span>&gt;</span>Some<span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">			<span class="tag">&lt;<span class="name">pre</span>&gt;</span>model = &#123;&#123;content&#125;&#125;<span class="tag">&lt;/<span class="name">pre</span>&gt;</span></div><div class="line">		<span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">	<span class="tag">&lt;/<span class="name">body</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></div></pre></td></tr></table></figure>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line">angular.module(<span class="string">'form-example2'</span>, []).directive(<span class="string">'contenteditable'</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">	<span class="keyword">return</span> &#123;</div><div class="line">		<span class="attr">require</span> : <span class="string">'ngModel'</span>,</div><div class="line">		<span class="attr">link</span> : <span class="function"><span class="keyword">function</span>(<span class="params">scope, elm, attrs, ctrl</span>) </span>&#123;</div><div class="line">			<span class="comment">// view -&gt; model</span></div><div class="line">			elm.bind(<span class="string">'keyup'</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">				scope.$apply(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">					ctrl.$setViewValue(elm.text());</div><div class="line">				&#125;);</div><div class="line">			&#125;);</div><div class="line"></div><div class="line">			<span class="comment">// model -&gt; view</span></div><div class="line">			ctrl.$render = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">				elm.html(ctrl.$viewValue);</div><div class="line">			&#125;;</div><div class="line"></div><div class="line">			<span class="comment">// load init value from DOM</span></div><div class="line">			ctrl.$setViewValue(elm.html());</div><div class="line">		&#125;</div><div class="line">	&#125;;</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<h3 id="自定义指令"><a href="#自定义指令" class="headerlink" title="自定义指令"></a>自定义指令</h3><p><img src="/images/expander.png" alt="img"></p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">ng-app</span>=<span class="string">'expanderModule'</span>&gt;</span></div><div class="line">	<span class="tag">&lt;<span class="name">head</span>&gt;</span></div><div class="line">		<span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">"content-type"</span> <span class="attr">content</span>=<span class="string">"text/html; charset=utf-8"</span> /&gt;</span></div><div class="line">		<span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">"stylesheet"</span> <span class="attr">type</span>=<span class="string">"text/css"</span> <span class="attr">href</span>=<span class="string">"ExpanderSimple.css"</span>/&gt;</span></div><div class="line">		<span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"framework/angular-1.3.0.14/angular.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></div><div class="line">		<span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"ExpanderSimple.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></div><div class="line">	<span class="tag">&lt;/<span class="name">head</span>&gt;</span></div><div class="line">	<span class="tag">&lt;<span class="name">body</span>&gt;</span></div><div class="line">		<span class="tag">&lt;<span class="name">div</span> <span class="attr">ng-controller</span>=<span class="string">'SomeController'</span>&gt;</span></div><div class="line">			<span class="tag">&lt;<span class="name">expander</span> <span class="attr">class</span>=<span class="string">'expander'</span> <span class="attr">expander-title</span>=<span class="string">'title'</span>&gt;</span></div><div class="line">				&#123;&#123;text&#125;&#125;</div><div class="line">			<span class="tag">&lt;/<span class="name">expander</span>&gt;</span></div><div class="line">		<span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">	<span class="tag">&lt;/<span class="name">body</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></div></pre></td></tr></table></figure>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> expanderModule=angular.module(<span class="string">'expanderModule'</span>, []);</div><div class="line">expanderModule.directive(<span class="string">'expander'</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">	<span class="keyword">return</span> &#123;</div><div class="line">      <span class="comment">//这里我们的匹配模式定义的是也可以用元素也可以用属性</span></div><div class="line">		restrict : <span class="string">'EA'</span>,</div><div class="line">      <span class="comment">// 替换</span></div><div class="line">		replace : <span class="literal">true</span>,</div><div class="line">      <span class="comment">//内部的内容是可以变换的</span></div><div class="line">		transclude : <span class="literal">true</span>,</div><div class="line">		<span class="attr">scope</span> : &#123;</div><div class="line">          <span class="comment">//用=号进行scope双向数据绑定</span></div><div class="line">			title : <span class="string">'=expanderTitle'</span></div><div class="line">		&#125;,</div><div class="line">      <span class="comment">//ng-click="toggle()这里的click只能调用我们内部的toggle</span></div><div class="line">		template : <span class="string">'&lt;div&gt;'</span></div><div class="line">				 + <span class="string">'&lt;div class="title" ng-click="toggle()"&gt;&#123;&#123;title&#125;&#125;&lt;/div&gt;'</span></div><div class="line">				 + <span class="string">'&lt;div class="body" ng-show="showMe" ng-transclude&gt;&lt;/div&gt;'</span></div><div class="line">				 + <span class="string">'&lt;/div&gt;'</span>,</div><div class="line">		<span class="attr">link</span> : <span class="function"><span class="keyword">function</span>(<span class="params">scope, element, attrs</span>) </span>&#123;</div><div class="line">			scope.showMe = <span class="literal">false</span>;</div><div class="line">          <span class="comment">//这里我们定义的toggle只能在指令内部进行调用</span></div><div class="line">			scope.toggle = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">				scope.showMe = !scope.showMe;</div><div class="line">			&#125;</div><div class="line">		&#125;</div><div class="line">	&#125;</div><div class="line">&#125;);</div><div class="line">expanderModule.controller(<span class="string">'SomeController'</span>,<span class="function"><span class="keyword">function</span>(<span class="params">$scope</span>) </span>&#123;</div><div class="line">    $scope.title = <span class="string">'点击展开'</span>;</div><div class="line">	$scope.text = <span class="string">'这里是内部的内容。'</span>;</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<figure class="highlight css"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="selector-class">.expander</span> &#123;</div><div class="line">	<span class="attribute">border</span>: <span class="number">1px</span> solid black;</div><div class="line">	<span class="attribute">width</span>: <span class="number">250px</span>;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="selector-class">.expander</span>&gt;<span class="selector-class">.title</span> &#123;</div><div class="line">	<span class="attribute">background-color</span>: black;</div><div class="line">	<span class="attribute">color</span>: white;</div><div class="line">	<span class="attribute">padding</span>: .<span class="number">1em</span> .<span class="number">3em</span>;</div><div class="line">	<span class="attribute">cursor</span>: pointer;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="selector-class">.expander</span>&gt;<span class="selector-class">.body</span> &#123;</div><div class="line">	<span class="attribute">padding</span>: .<span class="number">1em</span> .<span class="number">3em</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>再来一个</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">ng-app</span>=<span class="string">"expanderModule"</span>&gt;</span></div><div class="line">	<span class="tag">&lt;<span class="name">head</span>&gt;</span></div><div class="line">		<span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">"content-type"</span> <span class="attr">content</span>=<span class="string">"text/html; charset=utf-8"</span> /&gt;</span></div><div class="line">		<span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">"stylesheet"</span> <span class="attr">type</span>=<span class="string">"text/css"</span> <span class="attr">href</span>=<span class="string">"Accordion.css"</span>/&gt;</span></div><div class="line">		<span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"framework/angular-1.3.0.14/angular.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></div><div class="line">		<span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"Accordion.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></div><div class="line">	<span class="tag">&lt;/<span class="name">head</span>&gt;</span></div><div class="line">	<span class="tag">&lt;<span class="name">body</span> <span class="attr">ng-controller</span>=<span class="string">'SomeController'</span> &gt;</span></div><div class="line">		<span class="tag">&lt;<span class="name">accordion</span>&gt;</span></div><div class="line">			<span class="tag">&lt;<span class="name">expander</span> <span class="attr">class</span>=<span class="string">'expander'</span> <span class="attr">ng-repeat</span>=<span class="string">'expander in expanders'</span> <span class="attr">expander-title</span>=<span class="string">'expander.title'</span>&gt;</span></div><div class="line">				&#123;&#123;expander.text&#125;&#125;</div><div class="line">			<span class="tag">&lt;/<span class="name">expander</span>&gt;</span></div><div class="line">		<span class="tag">&lt;/<span class="name">accordion</span>&gt;</span></div><div class="line">	<span class="tag">&lt;/<span class="name">body</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></div></pre></td></tr></table></figure>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> expModule=angular.module(<span class="string">'expanderModule'</span>,[])</div><div class="line">expModule.directive(<span class="string">'accordion'</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">	<span class="keyword">return</span> &#123;</div><div class="line">		<span class="attr">restrict</span> : <span class="string">'EA'</span>,</div><div class="line">		<span class="attr">replace</span> : <span class="literal">true</span>,</div><div class="line">		<span class="attr">transclude</span> : <span class="literal">true</span>,</div><div class="line">		<span class="attr">template</span> : <span class="string">'&lt;div ng-transclude&gt;&lt;/div&gt;'</span>,</div><div class="line">      <span class="comment">//对外暴露方法</span></div><div class="line">		controller : <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">			<span class="keyword">var</span> expanders = [];</div><div class="line">			<span class="keyword">this</span>.gotOpened = <span class="function"><span class="keyword">function</span>(<span class="params">selectedExpander</span>) </span>&#123;</div><div class="line">				angular.forEach(expanders, <span class="function"><span class="keyword">function</span>(<span class="params">expander</span>) </span>&#123;</div><div class="line">					<span class="keyword">if</span> (selectedExpander != expander) &#123;</div><div class="line">						expander.showMe = <span class="literal">false</span>;</div><div class="line">					&#125;</div><div class="line">				&#125;);</div><div class="line">			&#125;</div><div class="line">			<span class="keyword">this</span>.addExpander = <span class="function"><span class="keyword">function</span>(<span class="params">expander</span>) </span>&#123;</div><div class="line">				expanders.push(expander);</div><div class="line">			&#125;</div><div class="line">		&#125;</div><div class="line">	&#125;</div><div class="line">&#125;);</div><div class="line"></div><div class="line">expModule.directive(<span class="string">'expander'</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">	<span class="keyword">return</span> &#123;</div><div class="line">		<span class="attr">restrict</span> : <span class="string">'EA'</span>,</div><div class="line">		<span class="attr">replace</span> : <span class="literal">true</span>,</div><div class="line">		<span class="attr">transclude</span> : <span class="literal">true</span>,</div><div class="line">      <span class="comment">//依赖于accordion指令</span></div><div class="line">		<span class="built_in">require</span> : <span class="string">'^?accordion'</span>,</div><div class="line">		<span class="attr">scope</span> : &#123;</div><div class="line">			<span class="attr">title</span> : <span class="string">'=expanderTitle'</span></div><div class="line">		&#125;,</div><div class="line">		<span class="attr">template</span> : <span class="string">'&lt;div&gt;'</span></div><div class="line">				  + <span class="string">'&lt;div class="title" ng-click="toggle()"&gt;&#123;&#123;title&#125;&#125;&lt;/div&gt;'</span></div><div class="line">				  + <span class="string">'&lt;div class="body" ng-show="showMe" ng-transclude&gt;&lt;/div&gt;'</span></div><div class="line">				  + <span class="string">'&lt;/div&gt;'</span>,</div><div class="line">		<span class="attr">link</span> : <span class="function"><span class="keyword">function</span>(<span class="params">scope, element, attrs, accordionController</span>) </span>&#123;</div><div class="line">			scope.showMe = <span class="literal">false</span>;</div><div class="line">			accordionController.addExpander(scope);</div><div class="line">			scope.toggle = <span class="function"><span class="keyword">function</span> <span class="title">toggle</span>(<span class="params"></span>) </span>&#123;</div><div class="line">				scope.showMe = !scope.showMe;</div><div class="line">				accordionController.gotOpened(scope);</div><div class="line">			&#125;</div><div class="line">		&#125;</div><div class="line">	&#125;</div><div class="line">&#125;);</div><div class="line"></div><div class="line">expModule.controller(<span class="string">"SomeController"</span>,<span class="function"><span class="keyword">function</span>(<span class="params">$scope</span>) </span>&#123;</div><div class="line">	$scope.expanders = [&#123;</div><div class="line">		<span class="attr">title</span> : <span class="string">'Click me to expand'</span>,</div><div class="line">		<span class="attr">text</span> : <span class="string">'Hi there folks, I am the content that was hidden but is now shown.'</span></div><div class="line">	&#125;, &#123;</div><div class="line">		<span class="attr">title</span> : <span class="string">'Click this'</span>,</div><div class="line">		<span class="attr">text</span> : <span class="string">'I am even better text than you have seen previously'</span></div><div class="line">	&#125;, &#123;</div><div class="line">		<span class="attr">title</span> : <span class="string">'Test'</span>,</div><div class="line">		<span class="attr">text</span> : <span class="string">'test'</span></div><div class="line">	&#125;];</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<figure class="highlight css"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="selector-class">.expander</span> &#123;</div><div class="line">	<span class="attribute">border</span>: <span class="number">1px</span> solid black;</div><div class="line">	<span class="attribute">width</span>: <span class="number">250px</span>;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="selector-class">.expander</span>&gt;<span class="selector-class">.title</span> &#123;</div><div class="line">	<span class="attribute">background-color</span>: black;</div><div class="line">	<span class="attribute">color</span>: white;</div><div class="line">	<span class="attribute">padding</span>: .<span class="number">1em</span> .<span class="number">3em</span>;</div><div class="line">	<span class="attribute">cursor</span>: pointer;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="selector-class">.expander</span>&gt;<span class="selector-class">.body</span> &#123;</div><div class="line">	<span class="attribute">padding</span>: .<span class="number">1em</span> .<span class="number">3em</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>看到没，其实编写自定义指令还是比较困难的，所以我们可以去引入一些第三方的指令库</p>
<p><img src="/images/angular-ui.png" alt="img"></p>
<p>这样子，就可以极大地方便实现我们想要的功能了</p>
<p>再来个难一点的自定义指令</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&lt;!doctype html&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">ng-app</span>=<span class="string">"MyModule"</span>&gt;</span></div><div class="line"></div><div class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"utf-8"</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">"stylesheet"</span> <span class="attr">href</span>=<span class="string">"framework/bootstrap-3.0.0/css/bootstrap.css"</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">"stylesheet"</span> <span class="attr">href</span>=<span class="string">"common.css"</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"framework/angular-1.3.0.14/angular.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"framework/ui-bootstrap-tpls-0.11.0.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"Accordion-ngui.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></div><div class="line"></div><div class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"container"</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"row"</span>&gt;</span></div><div class="line">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"col-md-12"</span>&gt;</span></div><div class="line">                <span class="tag">&lt;<span class="name">div</span> <span class="attr">ng-controller</span>=<span class="string">"AccordionDemoCtrl"</span>&gt;</span></div><div class="line">                    <span class="tag">&lt;<span class="name">p</span>&gt;</span></div><div class="line">                        <span class="tag">&lt;<span class="name">button</span> <span class="attr">class</span>=<span class="string">"btn btn-default btn-md"</span> <span class="attr">ng-click</span>=<span class="string">"status.open = !status.open"</span>&gt;</span>Toggle last panel<span class="tag">&lt;/<span class="name">button</span>&gt;</span></div><div class="line">                        <span class="tag">&lt;<span class="name">button</span> <span class="attr">class</span>=<span class="string">"btn btn-default btn-md"</span> <span class="attr">ng-click</span>=<span class="string">"status.isFirstDisabled = ! status.isFirstDisabled"</span>&gt;</span>Enable / Disable first panel<span class="tag">&lt;/<span class="name">button</span>&gt;</span></div><div class="line">                    <span class="tag">&lt;/<span class="name">p</span>&gt;</span></div><div class="line"></div><div class="line">                    <span class="tag">&lt;<span class="name">label</span> <span class="attr">class</span>=<span class="string">"checkbox"</span>&gt;</span></div><div class="line">                        <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"checkbox"</span> <span class="attr">ng-model</span>=<span class="string">"oneAtATime"</span>&gt;</span>Open only one at a time</div><div class="line">                    <span class="tag">&lt;/<span class="name">label</span>&gt;</span></div><div class="line">                    <span class="tag">&lt;<span class="name">accordion</span> <span class="attr">close-others</span>=<span class="string">"oneAtATime"</span>&gt;</span></div><div class="line">                        <span class="tag">&lt;<span class="name">accordion-group</span> <span class="attr">heading</span>=<span class="string">"Static Header, initially expanded"</span> <span class="attr">is-open</span>=<span class="string">"status.isFirstOpen"</span> <span class="attr">is-disabled</span>=<span class="string">"status.isFirstDisabled"</span>&gt;</span></div><div class="line">                            This content is straight in the template.</div><div class="line">                        <span class="tag">&lt;/<span class="name">accordion-group</span>&gt;</span></div><div class="line">                        <span class="tag">&lt;<span class="name">accordion-group</span> <span class="attr">heading</span>=<span class="string">"&#123;&#123;group.title&#125;&#125;"</span> <span class="attr">ng-repeat</span>=<span class="string">"group in groups"</span>&gt;</span></div><div class="line">                            &#123;&#123;group.content&#125;&#125;</div><div class="line">                        <span class="tag">&lt;/<span class="name">accordion-group</span>&gt;</span></div><div class="line">                        <span class="tag">&lt;<span class="name">accordion-group</span> <span class="attr">heading</span>=<span class="string">"Dynamic Body Content"</span>&gt;</span></div><div class="line">                            <span class="tag">&lt;<span class="name">p</span>&gt;</span>The body of the accordion group grows to fit the contents<span class="tag">&lt;/<span class="name">p</span>&gt;</span></div><div class="line">                            <span class="tag">&lt;<span class="name">button</span> <span class="attr">class</span>=<span class="string">"btn btn-default btn-md"</span> <span class="attr">ng-click</span>=<span class="string">"addItem()"</span>&gt;</span>Add Item<span class="tag">&lt;/<span class="name">button</span>&gt;</span></div><div class="line">                            <span class="tag">&lt;<span class="name">div</span> <span class="attr">ng-repeat</span>=<span class="string">"item in items"</span>&gt;</span>&#123;&#123;item&#125;&#125;<span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">                        <span class="tag">&lt;/<span class="name">accordion-group</span>&gt;</span></div><div class="line">                        <span class="tag">&lt;<span class="name">accordion-group</span> <span class="attr">is-open</span>=<span class="string">"status.open"</span>&gt;</span></div><div class="line">                            <span class="tag">&lt;<span class="name">accordion-heading</span>&gt;</span></div><div class="line">                                I can have markup, too! <span class="tag">&lt;<span class="name">i</span> <span class="attr">class</span>=<span class="string">"pull-right glyphicon"</span> <span class="attr">ng-class</span>=<span class="string">"&#123;'glyphicon-chevron-down': status.open, 'glyphicon-chevron-right': !status.open&#125;"</span>&gt;</span><span class="tag">&lt;/<span class="name">i</span>&gt;</span></div><div class="line">                            <span class="tag">&lt;/<span class="name">accordion-heading</span>&gt;</span></div><div class="line">                            This is just some content to illustrate fancy headings.</div><div class="line">                        <span class="tag">&lt;/<span class="name">accordion-group</span>&gt;</span></div><div class="line">                    <span class="tag">&lt;/<span class="name">accordion</span>&gt;</span></div><div class="line">                <span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line"></div><div class="line">            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line"></div><div class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></div><div class="line"></div><div class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></div></pre></td></tr></table></figure>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> myModule = angular.module(<span class="string">'MyModule'</span>, [<span class="string">'ui.bootstrap'</span>]);</div><div class="line">myModule.controller(<span class="string">'AccordionDemoCtrl'</span>, [<span class="string">'$scope'</span>,</div><div class="line">    <span class="function"><span class="keyword">function</span>(<span class="params">$scope</span>) </span>&#123;</div><div class="line"></div><div class="line">        $scope.oneAtATime = <span class="literal">true</span>;</div><div class="line"></div><div class="line">        $scope.groups = [&#123;</div><div class="line">            <span class="attr">title</span>: <span class="string">'Dynamic Group Header - 1'</span>,</div><div class="line">            <span class="attr">content</span>: <span class="string">'Dynamic Group Body - 1'</span></div><div class="line">        &#125;, &#123;</div><div class="line">            <span class="attr">title</span>: <span class="string">'Dynamic Group Header - 2'</span>,</div><div class="line">            <span class="attr">content</span>: <span class="string">'Dynamic Group Body - 2'</span></div><div class="line">        &#125;];</div><div class="line"></div><div class="line">        $scope.items = [<span class="string">'Item 1'</span>, <span class="string">'Item 2'</span>, <span class="string">'Item 3'</span>];</div><div class="line"></div><div class="line">        $scope.addItem = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">            <span class="keyword">var</span> newItemNo = $scope.items.length + <span class="number">1</span>;</div><div class="line">            $scope.items.push(<span class="string">'Item '</span> + newItemNo);</div><div class="line">        &#125;;</div><div class="line"></div><div class="line">        $scope.status = &#123;</div><div class="line">            <span class="attr">isFirstOpen</span>: <span class="literal">true</span>,</div><div class="line">            <span class="attr">isFirstDisabled</span>: <span class="literal">false</span></div><div class="line">        &#125;;</div><div class="line">    &#125;</div><div class="line">])</div></pre></td></tr></table></figure>
</div></article></div></main><footer><div class="paginator"><a href="/2017/03/05/JavaScript/JavaScript API/" class="prev">PREV</a><a href="/2017/01/26/规范/AMD之requirejs/" class="next">NEXT</a></div><div class="copyright"><p>© 2014 - 2017 <a href="https://github.com/xuhongbo" target="_blank">xuhongbo-github</a>.</p></div></footer></div><script async src="//cdn.bootcss.com/mathjax/2.7.0/MathJax.js?config=TeX-MML-AM_CHTML" integrity="sha384-crwIf/BuaWM9rM65iM+dWFldgQ1Un8jWZMuh3puxb8TOY9+linwLoI7ZHZT+aekW" crossorigin="anonymous"></script><script>(function(b,o,i,l,e,r){b.GoogleAnalyticsObject=l;b[l]||(b[l]=function(){(b[l].q=b[l].q||[]).push(arguments)});b[l].l=+new Date;e=o.createElement(i);r=o.getElementsByTagName(i)[0];e.src='//www.google-analytics.com/analytics.js';r.parentNode.insertBefore(e,r)}(window,document,'script','ga'));ga('create',"UA-65933410-1",'auto');ga('send','pageview');</script></body></html>